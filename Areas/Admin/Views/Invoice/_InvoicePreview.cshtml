@model HotelManagementSystem.Models.ViewModels.Invoice.InvoiceViewModel
@{
    ViewData["Title"] = $"Xem Hóa đơn {Model.InvoiceNumber}";
    Layout = null; // No layout for PDF preview
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <style>
        body {
            background-color: #f5f5f5;
            font-family: 'Arial', sans-serif;
        }
        .invoice-container {
            max-width: 800px;
            margin: 30px auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .invoice-header {
            border-bottom: 3px solid #007bff;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .invoice-title {
            font-size: 32px;
            font-weight: bold;
            color: #007bff;
        }
        .invoice-number {
            font-size: 18px;
            color: #666;
        }
        .section-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #eee;
        }
        .info-row {
            margin-bottom: 8px;
        }
        .info-label {
            font-weight: bold;
            color: #555;
        }
        .amount-table {
            margin-top: 30px;
        }
        .total-row {
            font-size: 18px;
            font-weight: bold;
            background-color: #f8f9fa;
        }
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 120px;
            color: rgba(0,0,0,0.05);
            z-index: -1;
            font-weight: bold;
        }
        @@media print {
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="watermark">MOCK INVOICE</div>
    
    <div class="invoice-container">
        <!-- Print Button (No print) -->
        <div class="text-end mb-3 no-print">
            <button onclick="window.print()" class="btn btn-primary">
                <i class="fas fa-print"></i> In Hóa đơn
            </button>
            <button onclick="window.close()" class="btn btn-secondary">
                Đóng
            </button>
        </div>

        <!-- Invoice Header -->
        <div class="invoice-header">
            <div class="row">
                <div class="col-6">
                    <div class="invoice-title">HÓA ĐƠN</div>
                    <div class="invoice-number">@Model.InvoiceNumber</div>
                </div>
                <div class="col-6 text-end">
                    <h4>@Model.HotelName</h4>
                    <p class="mb-0">Ngày phát hành: @Model.IssuedAt.ToString("dd/MM/yyyy")</p>
                    <p class="mb-0">
                        <span class="badge @Model.StatusBadgeClass">@Model.StatusDisplay</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- Customer Info -->
        <div class="mb-4">
            <div class="section-title">THÔNG TIN KHÁCH HÀNG</div>
            <div class="info-row">
                <span class="info-label">Họ tên:</span> @Model.GuestName
            </div>
            @if (!string.IsNullOrEmpty(Model.GuestEmail))
            {
                <div class="info-row">
                    <span class="info-label">Email:</span> @Model.GuestEmail
                </div>
            }
            @if (!string.IsNullOrEmpty(Model.GuestPhone))
            {
                <div class="info-row">
                    <span class="info-label">Điện thoại:</span> @Model.GuestPhone
                </div>
            }
        </div>

        <!-- Booking Info -->
        <div class="mb-4">
            <div class="section-title">THÔNG TIN BOOKING</div>
            <div class="row">
                <div class="col-6">
                    <div class="info-row">
                        <span class="info-label">Mã Booking:</span> @Model.BookingCode
                    </div>
                    <div class="info-row">
                        <span class="info-label">Phòng:</span> @Model.RoomNumber - @Model.RoomTypeName
                    </div>
                </div>
                <div class="col-6">
                    <div class="info-row">
                        <span class="info-label">Check-in:</span> @Model.CheckInDate.ToString("dd/MM/yyyy")
                    </div>
                    <div class="info-row">
                        <span class="info-label">Check-out:</span> @Model.CheckOutDate.ToString("dd/MM/yyyy")
                    </div>
                    <div class="info-row">
                        <span class="info-label">Số đêm:</span> @Model.Nights đêm
                    </div>
                </div>
            </div>
        </div>

        <!-- Amount Breakdown -->
        <div class="amount-table">
            <table class="table table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Mô tả</th>
                        <th class="text-end" style="width: 200px;">Số tiền (VNĐ)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Tiền phòng (@Model.Nights đêm)</td>
                        <td class="text-end">@Model.RoomCharge.ToString("N0")</td>
                    </tr>
                    @if (Model.DiscountAmount > 0)
                    {
                        <tr>
                            <td>Giảm giá</td>
                            <td class="text-end text-success">-@Model.DiscountAmount.ToString("N0")</td>
                        </tr>
                    }
                    <tr>
                        <td>Thuế VAT (10%)</td>
                        <td class="text-end">@Model.TaxAmount.ToString("N0")</td>
                    </tr>
                    <tr>
                        <td>Phí dịch vụ (5%)</td>
                        <td class="text-end">@Model.ServiceCharge.ToString("N0")</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>TỔNG CỘNG</strong></td>
                        <td class="text-end"><strong>@Model.TotalAmount.ToString("N0")</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Payment Status -->
        <div class="mt-4">
            <div class="section-title">TRẠNG THÁI THANH TOÁN</div>
            @if (Model.IsPaid && Model.PaidAt.HasValue)
            {
                <div class="alert alert-success">
                    <strong>✓ Đã thanh toán</strong><br />
                    Ngày thanh toán: @Model.PaidAt.Value.ToString("dd/MM/yyyy HH:mm")<br />
                    @if (!string.IsNullOrEmpty(Model.PaymentMethod))
                    {
                        <span>Phương thức: @Model.PaymentMethod</span>
                    }
                </div>
            }
            else if (Model.IsCancelled)
            {
                <div class="alert alert-danger">
                    <strong>✗ Hóa đơn đã bị hủy</strong>
                </div>
            }
            else
            {
                <div class="alert alert-warning">
                    <strong>⚠ Chưa thanh toán</strong>
                </div>
            }
        </div>

        @if (!string.IsNullOrEmpty(Model.Notes))
        {
            <div class="mt-4">
                <div class="section-title">GHI CHÚ</div>
                <p>@Model.Notes</p>
            </div>
        }

        <!-- Footer -->
        <div class="mt-5 pt-4 border-top text-center text-muted">
            <small>
                Hóa đơn được tạo tự động từ hệ thống quản lý khách sạn<br />
                <strong class="text-danger">ĐÂY LÀ HÓA ĐƠN MOCK - CHỨC NĂNG DEMO</strong>
            </small>
        </div>
    </div>

    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
